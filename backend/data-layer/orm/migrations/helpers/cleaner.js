import db from '../../index.js';

const MIGRATIONS_TO_CLEAN = [
  '20170512221600_client_script_for_delete_actions.js',
  '20170515204800_set_default_condition_script_for_base_db_rules.js',
  '20170518223600_update_sort_orders_in_layouts.js',
  '20170522230900_make_order_field_not_required.js',
  '20170522233200_add_format_option_for_alias_fields_of_core_models.js',
  '20170522234600_add_format_option_for_email_field_of_user_models.js',
  '20170528150200_remove_deprecated_findById_method_from_model_api.js',
  '20170528154400_update_required_when_script_for_actions.js',
  '20170601164400_update_server_script_for_save_privileges_action.js',
  '20170606232400_change_type_of_message_column_of_logs.js',
  '20170601154400_update_action_types.js',
  '20170613154400_update_form_options_field.js',
  '20170613156400_update_forms_options.js',
  '20170614234600_add_format_option_for_email_field_of_user_models.js',
  '20170611225700_rename_core_group_and_related_resources.js',
  '20170614224000_update_pages_access_script.js',
  '20170615234500_update_models_access_scripts.js',
  '20170617113600_update_actions_condition_scripts.js',
  '20170613154400_update_action_types.js',
  '20170708231100_update_fields_types.js',
  '20170715230800_update_privileges_action.js',
  '20170715232600_update_privilege_manager_page.js',
  '20170712113600_update_actions_condition_scripts.js',
  '20170608232400_update_destroy_action.js',
  '20170729232400_update_action_types.js',
  '20170730232400_update_action_types.js',
  '20170730232500_clean_up_actions.js',
  '20170808224500_increase_size_of_script_fields.js',
  '20170808242500_clean_up_actions.js',
  '20171110314500_update_actions_in_base_actions.js',
  '20170809232500_clean_up_actions.js',
  '20170813114100_clean_up_actions.js',
  '20170814234600_update_options_field_in_forms.js',
  '20170818225600_convert_float_fields_to_double.js',
  '20170823234600_update_script_field_for_appearance_model.js',
  '20170719215200_make_esc_offset_and_re_enable_fields_optional.js',
  '20170730171500_update_permission_types.js',
  '20170821231500_add_versionable_attachments_to_models.js',
  '20170824140300_add___inserted_to_each_model.js',
  '20170825223400_update_core_actions.js',
  '20170826132400_add_active_switcher_to_actions.js',
  '20170906132400_set_core_models_order.js',
  '20170907140300_clean_up_float_nans.js',
  '20170908222800_update_presence_validation_for_actions_server_script.js',
  '20170911233700_update_condition_script_in_attach_files_action.js',
  '20170912222600_update_view_types.js',
  '20170912232000_update_attachments_default_layout.js',
  '20170914140300_update_attachments_longitude_field_alias.js',
  '20170914140300_update_forms_components.js',
  '20170915194400_migrate_attachments_in_form_options.js',
  '20170920222700_update_condition_script_for_attachments_views.js',
  '20170921232200_update_options_for_default_form_of_view.js',
  '20170922220600_rename_p_long_to_p_lon_for_attachments.js',
  '20170926132400_set_views_and_actions_default_order.js',
  '20170927232100_add_account_to_users.js',
  '20170927232400_move_part_of_users_to_accounts.js',
  '20170928225100_convert_nan_to_null_for_the_float_fields.js',
  '20170928232000_sync_users_table_with_its_new_structure.js',
  '20170930132000_update_fields_label_for_users_references.js',
  '20170930140300_update_middle_header_page.js',
  '20170930223000_add_static_token_to_accounts.js',
  '20171001135700_change_default_users_form.js',
  '20171003222600_update_action_types.js',
  '20171004222600_update_auth_user_action.js',
  '20171006225300_update_logout_action.js',
  '20171009222400_update_core_actions.js',
  '20171010234200_add_virtual_to_fields.js',
  '20171011215300_update_options_for_default_form_of_field.js',
  '20171011230300_update_options_for_default_form_of_user.js',
  '20171011230700_update_create_user_form_of_user.js',
  '20171011234000_update_create_action_of_user.js',
  '20171012223500_make_alias_field_of_sessions_uniq.js',
  '20171013222600_update_field_types.js',
  '20171013222600_update_model_types.js',
  '20171015131500_update_planned_escalation_meta.js',
  '20171017234500_block_type_of_field_from_changes.js',
  '20171020224500_update_privilege_managers_server_script.js',
  '20171020225500_update_list_delete_action.js',
  '20171024222400_update_access_script_for_some_pages.js',
  '20171031215800_update_layout_actions.js',
  '20171031223500_update_list_delete_actions.js',
  '20171103221200_remove_dashboards_action.js',
  '20171103232600_update_smtp_settings.js',
  '20171104144800_update_list_delete_action.js',
  '20171104175900_change_permissions_structure.js',
  '20171104181000_convert_permissions.js',
  '20171105112700_update_default_permissions_layout.js',
  '20171107215300_update_options_for_default_form_of_page.js',
  '20171107225400_update_access_script_for_layout_manager.js',
  '20171109222600_update_page_template_length.js',
  '20171111201500_cleanup_schema_by_fields.js',
  '20171115225400_update_server_script_for_layout_manager.js',
  '20171122215300_update_options_for_default_form_of_field.js',
  '20171122215300_update_options_for_default_form_of_model.js',
  '20171129225400_update_template_for_header_page.js',
  '20171204225400_update_settings_value_string_length.js',
  '20171213220100_update_readonly_when_script_for_some_models.js',
  '20171214222600_update_field_options_of_worklog.js',
  '20171220225800_add_audit_to_models.js',
  '20171221220100_update_themes_setting.js',
  '20171222221000_add_audit_to_fields.js',
  '20171228221000_update_filter_for_default_view_of_model.js',
  '20171228222000_update_condition_script_for_audit_views.js',
  '20171228231600_change_required_condition_for_account_field.js',
  '20171212233500_update_create_update_actions.js',
  '20180117220100_update_themes_setting.js',
  '20180126233600_update_themes_setting.js',
  '20180301220100_update_themes_setting.js',
  '20180325220100_update_themes_setting.js',
  '20180301220100_update_themes_setting.js',
  '20180325220100_update_themes_setting.js',
  '20171205222600_update_view_types.js',
  '20180107232500_add___translated_field_to_fields.js',
  '20180114121100_add_language_to_users_forms.js',
  '20180115222600_add_types_for_layouts.js',
  '20180116222600_update_options_field_for_layout.js',
  '20180118215300_update_options_for_default_form_of_attachment.js',
  '20180118222600_update_action_types.js',
  '20180119215300_update_options_for_default_layout_of_attachment.js',
  '20180122121100_add_home_page_to_users_forms.js',
  '20180122233600_update_type_options_for_email_model.js',
  '20180125121100_update_default_layout_options_for_log.js',
  '20180126171100_update_options_of_default_forms_for_field_and_action.js',
  '20180131221700_add_timestamp_to_logs.js',
  '20180202224500_add_depends_on_to_some_fields.js',
  '20180208171100_update_options_of_default_forms_for_field_and_action.js',
  '20180212222800_add_limit_for_fields_alias.js',
  '20180213171100_remove_setting_for_map_query_limit.js',
  '20180213171100_update_structure_for_card_layout_options.js',
  '20180303143500_change_translations_columns_from_varchar_255_to_text.js',
  '20180319232200_set_syntax_hl_for_fields.js',
  '20180329222600_update_template_for_logout_page.js',
  '20180401143700_update_field_types.js',
  '20180403222600_update_component_script_for_logout_page.js',
  '20180403252600_update_template_for_login_page.js',
  '20180406220100_update_static_translations.js',
  '20180410155900_update_core_actions.js',
  '20180415151600_update_core_new_action.js',
  '20180327220100_update_themes_setting.js',
  '20180330220100_update_themes_setting.js',
  '20180416220100_update_themes_setting.js',
  '20180521150100_update_filters_to_new_format.js',
  '201805271304200_update_themes_setting.js',
  '20180612144200_set_view_options.js',
  '20180721143200_update_server_script_for_layout_manager.js',
  '20180715234284_update_foreign_model_for_reference_options.js',
  '20180822222900_update_length_for_array_string_fields.js',
  '20180822223100_update_boolean_fields.js',
  '20180830105600_update_static_translations.js',
  '20180816140000_create_scheduled_tasks.js',
  '20180829180010_update_model_meta_actions.js',
  '20180912140000_create_scheduled_tasks.js',
  '20180918224100_update_options_for_fields_of_scheduled_task.js',
  '20180919224100_adjust_filter_queries.js',
  '20180927085300_create_ui_rules.js',
  '20180611220100_update_themes_setting.js',
  '20180709220100_update_themes_setting.js',
  '20181016105000_update_actions.js',
  '20181004105000_update_fields_of_scheduled_task.js',
  '20181102123000_rename_scheduled_task_columns.js',
  '20181102125900_update_attach_files_action.js',
  '20180102230500_create_t_cross.js',
  '20181126105000_update_fields_of_schedulet_task.js',
  '20181128163500_update_range_fields_of_templates.js',
  '20181001080000_update_themes_setting.js',
  '20190109223700_update_server_script_for_form_manager.js',
  '20190117223700_update_server_script_for_form_manager.js',
  '20190121223700_update_server_script_for_form_manager.js',
  '20190123223700_update_server_script_for_form_manager.js',
  '20190205130000_add_inventory_template_ui_rule.js',
  '20190301154500_update_scheduled_task_columns.js',
  '20190205120000_add_subtype_attr_to_fields.js',
  '20190409150300_add_rtl_actions.js',
  '20190505083500_add_rtl_actions.js',
  '20190606165300_add_rtl_actions.js',
  '20190618165300_add_rtl_actions.js',
  '20190815165300_add_rtl_actions.js',
  '20190905151500_add_rtl_actions.js',
  '20190913153700_add_rtl_actions.js',
  '20190723133300_update_rtl_sync_to_db_rule.js',
  '20190717165200_update_setup_new_password_page.js',
  '20190717165300_update_setup_new_password_page.js',
  '20190805223400_update_form_for_page.js',
  '20190516223300_update_fields_types.js',
  '20180724143000_update_server_script_for_form_manager.js',
  '20180822223700_update_server_script_for_form_manager.js',
  '20180822224300_update_server_script_for_form_manager.js',
  '20180828223700_update_server_script_for_form_manager.js',
  '20190325223700_update_server_script_for_form_manager.js',
  '20170407115500_create_planned_escalations.js',
  '20180815164000_update_planned_escalations.js',
  '20180920224100_update_options_for_fields_of_scheduled_task.js',
  '20181102124000_update_scheduled_task_default_form.js',
  '20181102123000_update_scheduled_task_fields.js',
  '20181102125000_update_fields_of_scheduled_task.js',
  '20181126224400_update_form_for_scheduled_task.js',
  '20181130122100_update_attach_files_action.js',
  '20200616134500_migrate_worklog_data.js',
  '20190801133300_update_auth_setting.js',
  '20200724223600_update_field_initialize_ui_rule.js',
  '20200724223700_update_field_initialize_ui_rule.js',
  '20200815174500_update_field_initialize_ui_rule.js',
  '20200817223700_update_field_initialize_ui_rule.js',
  '20202010220100_update_login_page.js',
  '20200730220100_update_system_sidebar_page.js',
  '20201101220100_update_middle_header_page.js',
  '20200730220100_update_middle_header_page.js',
  '20200810220100_update_middle_header_page.js',
  '20200812220100_update_middle_header_page.js',
  '20201101220100_update_layout_page.js',
  '20201115220100_update_layout_page.js',
  '20200810220100_update_layout_page.js',
  '20200806220100_update_layout_page.js',
  '20200730220100_update_layout_page.js',
  '20201122220200_update_scheduled_task_model_metadata.js',
  '20200810220100_update_header_container_page.js',
  '20201117220100_update_middle_header_page.js',
  '20180724143200_update_server_script_for_layout_manager.js',
  '20180822225000_update_server_script_for_layout_manager.js',
  '20180927225000_update_server_script_for_layout_manager.js',
  '20190611223700_update_server_script_for_layout_manager.js',
  '20201117220100_update_layout_page.js',
  '20190116220600_update_server_script_for_privilege_manager.js',
  '20190621223700_update_server_script_for_privilege_manager.js',
  '20201115230900_update_privilege_manager_page.js',
  '20201111220100_cleanup_empty_string_values.js',
  '20201124220100_update_privilege_manager_page.js',
  '20201127220100_update_privilege_manager_page.js',
  '20201203220100_create_function_get_records_by_distance.js',
  '20201204220100_create_function_get_records_by_distance.js',
  '20213030220100_update_privilege_manager_page.js',
  '20213030920100_update_privilege_manager_page.js',
  '20201020220100_update_login_page.js',
  '20210331220100_update_login_page.js',
  '20210510125500_update_fields_of_view.js',
  '20200601220100_update_login_page.js',
  '20191008220100_update_login_page.js',
  '20200923220100_update_login_page.js',
  '20210506220100_update_login_page.js',
  '20201007220100_update_login_page.js',
  '20180822222700_update_template_and_component_script_for_login_page.js',
  '20190919085000_update_setup_new_password_page.js',
  '20200601220200_update_start_page.js',
  '20200928220200_update_header_container_page.js',
  '20201101220100_update_header_container_page.js',
  '20201120220100_update_header_container_page.js',
  '20200812220100_update_right_header_page.js',
  '20201120220100_update_middle_header_page.js',
  '20210430122000_update_middle_header_page.js',
  '20200806220100_update_content_container_page.js',
  '20201014220200_update_content_container_page.js',
  '20200928220200_update_content_container_page.js',
  '20201115220200_update_content_container_page.js',
  '20201117220100_update_sidebar_container_page.js',
  '20201125220100_update_layout_page.js',
  '20210526221300_update_layout_page.js',
  '20210526221100_update_content_container_page.js',
  '20210526221200_update_sidebar_container_page.js',
  '20210525220100_update_change_password_page.js',
  '20210525220200_update_create_account_page.js',
  '20210525220300_update_email_confirmation_page.js',
  '20210525220400_update_login_page.js',
  '20210525220500_update_password_recovery_page.js',
  '20210525220600_update_setup_new_password_page.js',
  '20210525220700_update_sso_no_access_page.js',
  '20210525220800_update_no_found_page.js',
  '20210525220900_update_start_page.js',
  '20210526220800_update_header_container_page.js',
  '20210526220900_update_left_header_page.js',
  '20210526220900_update_middle_header_page.js',
  '20210526220900_update_right_header_page.js',
  '20210526221300_update_sidebar_container_page.js',
  '20210526221400_update_layout_page.js',
  '20210622220000_update_layout_page.js',
  '20210602221100_update_content_container_page.js',
  '20190524220100_update_themes_setting.js',
  '20190927220100_update_themes_setting.js',
  '20210708220100_update_themes_setting.js',
  '20210622220000_update_left_header_page.js',
  '20210622220000_update_right_header_page.js',
  '20210622220100_update_right_header_page.js',
  '20210622220000_update_middle_header_page.js',
  '20210713220000_update_tutorial_page.js',
  '20210713220100_add_synchronization.js',
  '20210802001000__add_synchronization.js',
  '20210802001500_add_synchronization.js',
  '20181210223500_update_set_base_fields_db_rule.js',
  '20191008220100_update_set_base_fields_db_rule.js',
  '20210802002000_add_record_synchronization.js',
  '20180822224200_update_server_script_field_for_action.js',
  '20180326222600_update_action_types.js',
  '20180709122700_update_action_types.js',
  '20180822224100_update_action_types.js',
  '20190926224100_update_action_types.js',
  '20210802003000_add_synchronization.js',
  '20210802003500_add_record_synchronization.js',
  '20210822224200_update_server_script_field_for_action.js',
  '20210826226000_add_record_synchronization.js',
  '20210826226500_add_record_synchronization.js',
  '20210826224100_update_action_types.js',
  '20210826224200_update_action_types.js',
  '20211027224200_update_action_types.js',
  '20200504133500_update_submit_changed_password_action.js',
  '20211029224200_update_action_fields.js',
  '20211225225000_update_mc_settings.js',
  '20211225227500_update_field_ui-rule.js',
  '20211225224300_update_forms.js',
  '20211202074900_update_ui_rules.js',
  '20211109094700_update_ui_rules.js',
  '20211225225000_update_mc_settings.js',
  '20220127141000_update_email.js',
  '20220127143000_update_model_form.js',
  '20211225226000_update_mc_settings.js',
  '20211018221100_update_mc_setting.js',
  '20211215224300_update_fields.js',
  '20220118224300_update_fields.js',
  '20220118224300_update_forms.js',
  '20220118224300_update_ui_rules.js',
  '20220303200000_update_ui_rules.js',
  '20220303100000_update_fields.js',
  '20211225224300_update_forms.js',
  '20211222125400_update_auth_actions.js',
  '20220519225400_update_auth_actions.js',
  '20220601225400_update_auth_actions.js',
  '20220616224400_update_mc_settings.js',
  '20220422173000_update_forms.js',
  '20190829144000_update_attachments_settings.js',
  '20220127145000_update_mc_settings.js',
  '20220303200000_update_actions.js',
  '20180822224000_update_views_types.js',
  '20180822224600_update_appearance_types.js',
  '20220715020000_update_appearance_types.js',
  '20210510125600_update_fields_of_view.js',
  '20220715010000_update_fields_of_view.js',
  '20220401400000_update_fields.js',
  '20220715010000_update_fields.js',
  '20220808020000_update_fields.js',
  '20220708173000_delete_permissions.js',
  '20220712500000_create_map_draw_actions.js',
  '20220315224300_update_ui_rules.js',
  '20220712400000_update_fields.js',
  '20220718500000_create_map_draw_actions.js',
  '20220630173000_update_forms.js',
  '20220803500000_create_map_draw_actions.js',
  '20220315224300_update_forms.js',
  '20220825173000_update_forms.js',
  '20220903085300_create_geo_metadata_columns.js',
  '20220830173000_update_forms.js',
  '20220829500000_create_map_draw_actions.js',
  '20220315224300_update_fields.js',
  '20220725400000_update_fields.js',
  '20220809020000_update_fields.js',
  '20220914173000_update_forms.js',
  '20220708173000_update_views.js',
  '20220922173000_update_forms.js',
  '20220921113000_update_forms.js',
  '20191109143700_add_rtl_actions.js',
  '20220926320000_update_fields.js',
  '20220926333000_update_models.js',
  '20200810220200_update_form_manager_page.js',
  '20200817230900_update_form_manager_page.js',
  '20210215103000_update_server_script_for_form_manager.js',
  '20190805223400_update_layout_for_page.js',
  '20190805223500_update_form_for_page.js',
  '20220927093000_update_forms.js',
  '20220914174000_update_layouts.js',
  '20221003093000_update_forms.js',
  '20221003174000_update_layouts.js',
  '20200811220200_update_model_alias_autogeneration_ui_rule.js',
  '20221010220200_update_model_alias_autogeneration_ui_rule.js',
  '20221010230200_update_model_alias_autogeneration_ui_rule.js',
  '20220921500000_create_map_draw_actions.js',
  '20220928320000_update_fields.js',
  '20221004093000_update_forms.js',
  '20221004174000_update_layouts.js',
  '20221006500000_create_map_draw_actions.js',
  '20221012142000_update_document_template.js',
  '20220928320000_update_knex_seeding.js',
  '20220725224300_update_ui_rules.js',
  '20221007500000_cleanup_columns.js',
  '20200121220100_update_set_base_fields_db_rule.js',
  '20221013710000_update_ui_rules.js',
  '20220922173000_update_views.js',
  '20221013093000_update_forms.js',
  '20221017710000_update_ui_rules.js',
  '20191022111100_update_autogeneration_alias_ui_rule.js',
  '20221007620000_update_fields.js',
  '20221021620000_update_fields.js',
  '20221020710000_update_ui_rules.js',
  '20221018093000_update_forms.js',
  '20210622220000_update_login_page.js',
  '20221003183100_update_page_fields.js',
  '20221021500000_update_email_model.js',
  '20210622220000_update_setup_new_password_page.js',
  '20221024093000_update_forms.js',
  '20221107620000_update_fields.js',
  '20221108093000_update_forms.js',
  '20221117093000_update_forms.js',
  '20221018173000_update_views.js',
  '20221013174000_update_layouts.js',
  '20221117620000_update_fields.js',
  '20221013700000_update_knex_seeding.js',
  '20221027500000_create_map_draw_actions.js',
  '20221205500000_create_map_draw_actions.js',
  '20190611223700_update_server_script_for_save_user_layout_action.js',
  '20190822143000_update_server_script_for_save_user_layout_action.js',
  '20191028133400_update_save_user_layout_action.js',
  '20190920223600_update_field_initialize_ui_rule.js',
  '20191120223600_update_field_initialize_ui_rule.js',
  '20200817224700_update_field_initialize_ui_rule.js',
  '20200831224700_update_field_initialize_ui_rule.js',
  '20201016224700_update_field_initialize_ui_rule.js',
  '20221205600000_create_map_draw_actions.js',
  '20221215600000_create_map_draw_actions.js',
  '202301117131790_update_actions.js',
  '20221120093000_update_forms.js',
  '20221120174000_update_layouts.js',
  '20221202620000_update_geo_metadata_for_appearances.js',
  '20221225600000_create_map_draw_actions.js',
  '20221120620000_update_fields.js',
  '20230118093000_update_forms.js',
  '20230118174000_update_layouts.js',
  '20230120600000_create_map_draw_actions.js',
  '20230123020000_update_fields.js',
  '20221227131700_update_web_service_access_script.js',
  '20230123600000_create_map_draw_actions.js',
  '20230131600000_create_map_draw_actions.js',
  '20230214600000_create_map_draw_actions.js',
  '20230223600000_create_map_draw_actions.js',
  '20230223700000_create_map_draw_actions.js',
  '2023022705000_update_actions.js',
  '20230202713179_update_actions.js',
  '20220920103000_update_limits_setting.js',
  '20230123093000_update_forms.js',
  '20230207020000_update_fields.js',
  '20230430344700_update_metamodels_add_constraints_remove_duplicates.js',
  '20230224700000_create_map_draw_actions.js',
  '20220810500000_create_form_embedded_actions.js',
  '20230329020000_update_fields.js',
  '20230123174000_update_layouts.js',
  '20230210020000_update_forms.js',
  '20230505174000_update_layouts.js',
  '20220729105000_update_actions.js',
  '20230419344700_update_account_to_service_account.js',
  '20230521105000_update_actions.js',
  '20230526105000_update_actions.js',
];

export default () => {
  return db.client.schema.hasTable('knex_migrations').then((exists) => {
    if (exists) {
      return db.client.raw(
        `delete from knex_migrations where name IN (${MIGRATIONS_TO_CLEAN.map(
          (m) => `'${m}'`
        ).join(',')})`
      );
    }
  });
};
